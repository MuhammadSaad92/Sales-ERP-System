{% extends "base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'profit_report.css' %}">
{% endblock %}

{% block content %}
<div class="main-content">
    <div class="report-details">
        <h2>Profit Report</h2>
        <div class="date-filter-container">
            <form class="date-filter" method="GET" action="{% url 'profit_report' %}">
                <label for="fromDate">From</label>
                <input type="date" id="fromDate" name="fromDate" value="{{ from_date_str }}">
                <label for="toDate">To</label>
                <input type="date" id="toDate" name="toDate" value="{{ to_date_str }}">
                <button type="submit" class="find-btn">Find</button>
            </form>
            <form class="date-filter" method="GET" action="{% url 'profit_report' %}">
                <button type="submit" class="clear-btn">Clear</button>
            </form>
        </div>
        <div class="header-row">
            <div class="company-details">
                <h2>Demo Company</h2>
                <h5>Company Demo Address</h5>
                <h5>demo@mail.com</h5>
                <h5>123456</h5>
            </div>
            <div class="report-date">
                <p>Date: {{ report_date|date:"Y-m-d" }}</p>
            </div>
        </div>
        <div class="table-wrapper">
            <table class="stock-table">
                <thead>
                    <tr>
                        <th>Sales Date</th>
                        <th>Product Name</th>
                        <th>Product Model</th>
                        <th>Invoice No</th>
                        <th>Sale Rate</th>
                        <th>Sale Quantity</th>
                        <th>Sale Total</th>
                        <th>Cost Rate</th>
                        <th>Cost Total</th>
                        <th>Profit</th>
                    </tr>
                </thead>
                <tbody id="reportTableBody">
                    {% for item in profits %}
                    <tr class="stock-row">
                        <td>{{ item.sales_date|date:"Y-m-d" }}</td>
                        <td>{{ item.product_name|default:"-" }}</td>
                        <td>{{ item.product_model|default:"-" }}</td>
                        <td>{{ item.invoice_no }}</td>
                        <td>{{ item.sale_rate|floatformat:2 }}</td>
                        <td>{{ item.sale_quantity|default:"0" }}</td>
                        <td>{{ item.sale_total|floatformat:2 }}</td>
                        <td>{{ item.cost_rate|floatformat:2 }}</td>
                        <td>{{ item.cost_total|floatformat:2 }}</td>
                        <td>{{ item.profit|floatformat:2 }}</td>
                    </tr>
                    {% empty %}
                    <tr class="no-data">
                        <td colspan="10">No sales in selected date range</td>
                    </tr>
                    {% endfor %}
                </tbody>
                <tfoot>
                    {% if profits %}
                    <tr class="total-row">
                        <td colspan="6" style="text-align: right; padding-right: 25px; font-weight: bold;">Total :</td>
                        <td>{{ total_sale|floatformat:2 }}</td>
                        <td></td>
                        <td>{{ total_cost|floatformat:2 }}</td>
                        <td>{{ total_profit|floatformat:2 }}</td>
                    </tr>
                    {% endif %}
                </tfoot>
            </table>
        </div>
    </div>
</div>
{% endblock %}